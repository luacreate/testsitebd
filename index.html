<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Проверка доступа</title>
  <style>
    /* Стили для элементов */
    .hidden { display: none; }
    .error { color: red; }
  </style>
</head>
<body>
  <h1>Проверка доступа</h1>
  <input type="text" id="accountId" placeholder="Введите ваш ID">
  <button onclick="checkAccess()">Проверить доступ</button>
  <div class="error hidden" id="errorMsg">Ошибка: доступ запрещен.</div>
  <div class="loading hidden" id="loading">Загрузка...</div>
  <div id="mainContainer"></div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-firestore.js"></script>

  <script>
    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCBH3adMB558XFLlsLPmzRZSz2pkjz7lSQ",
      authDomain: "testbota-23cb1.firebaseapp.com",
      databaseURL: "https://testbota-23cb1-default-rtdb.firebaseio.com",
      projectId: "testbota-23cb1",
      storageBucket: "testbota-23cb1.firebasestorage.app",
      messagingSenderId: "1009808502725",
      appId: "1:1009808502725:web:d2fd0e30aa3fbee05425ac",
      measurementId: "G-XK0DBGYFW5"
    };

    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    async function checkAccess() {
      const accountId = document.getElementById("accountId").value;
      const errorMsg = document.getElementById("errorMsg");
      const loadingElement = document.getElementById("loading");
      const mainContainer = document.getElementById("mainContainer");

      // Скрываем ошибку и показываем загрузку
      errorMsg.classList.add("hidden");
      loadingElement.classList.remove("hidden");

      try {
        // Получаем документ по accountId из коллекции userIDs
        const docRef = db.collection("userIDs").doc(accountId);
        const doc = await docRef.get();

        // Прячем элемент загрузки
        loadingElement.classList.add("hidden");

        if (doc.exists && doc.data().isActive) {
          // Если документ найден и поле isActive == true
          mainContainer.innerHTML = `
            <a href="https://your-link-here.com" target="_blank">
                <img src="https://1winbd.com/wp-content/uploads/2022/10/lucky-jet-header.webp" alt="Логотип" class="logo" />
            </a>
            <h1>Добро пожаловать в игру!</h1>
            <button onclick="generateRandomMultiplier()">Получить сигнал</button>
          `;
        } else {
          // Если документ не найден или isActive != true
          errorMsg.textContent = "Ошибка: доступ запрещен. Пожалуйста, свяжитесь с поддержкой.";
          errorMsg.classList.remove("hidden");
        }
      } catch (error) {
        console.error("Ошибка при проверке ID:", error);
        loadingElement.classList.add("hidden");
        errorMsg.textContent = "Ошибка при проверке ID.";
        errorMsg.classList.remove("hidden");
      }
    }

    function generateRandomMultiplier() {
      const multiplier = Math.random().toFixed(2);
      alert(`Ваш сигнал: x${multiplier}`);
    }
  </script>
</body>
</html>
